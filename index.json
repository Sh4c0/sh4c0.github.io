[{"categories":["2021/10"],"content":"ä¼ é€é—¨ ","date":"2021-10-27","objectID":"/posts/cf1582e/:0:0","tags":["codeforces","dp"],"title":"Codeforces 1582E Pchelyonok and Segments","uri":"/posts/cf1582e/"},{"categories":["2021/10"],"content":"é¢˜æ„ å°†ä¸€ä¸ªæ•°ç»„åˆ’åˆ†æˆ$k$ä¸ªå­æ®µï¼Œå¯¹äºç¬¬$i$ä¸ªå­æ®µå’Œç¬¬$i+1$ä¸ªå­æ®µï¼Œéœ€è¦æ»¡è¶³å­æ®µ$i$çš„å…ƒç´ ä¸ªæ•°ä¸º$n-i+1$ï¼Œå­æ®µ$n-(i+1)+1$çš„å…ƒç´ ä¸ªæ•°ä¸º$i+1$ï¼Œå¹¶ä¸”å­æ®µ$i$çš„å…ƒç´ ä¹‹å’Œå°äºå­æ®µ$i+1$çš„å…ƒç´ ä¹‹å’Œï¼Œè¾“å‡º$k$çš„æœ€å¤§å€¼ ","date":"2021-10-27","objectID":"/posts/cf1582e/:0:1","tags":["codeforces","dp"],"title":"Codeforces 1582E Pchelyonok and Segments","uri":"/posts/cf1582e/"},{"categories":["2021/10"],"content":"æ€è·¯ é¦–å…ˆä¸éš¾çœ‹å‡ºé•¿åº¦ä¸º$n$çš„æ•°ç»„ï¼Œ$k$çš„å–å€¼æ»¡è¶³$(k+1)*k/2\\leqslant n$ æˆ‘ä»¬å°†æ•´ä¸ªæ•°ç»„å€’ç½®ï¼Œæ­¤æ—¶ç¬¬$i$ä¸ªå­æ®µçš„é•¿åº¦ä¸º$i$ï¼ŒåŒæ—¶é¢„å¤„ç†å‡ºå‰ç¼€å’Œ$pre$ æˆ‘ä»¬ä»¤$dp[i][j]$ä»£è¡¨å‰$i$ä¸ªå…ƒç´ ä¸­ï¼Œå­æ®µæ•°é‡ä¸º$k$çš„æƒ…å†µä¸­çš„ç¬¬$k$ä¸ªå­æ®µçš„æœ€å¤§å€¼ï¼Œå¦‚æœä¸å¯èƒ½åˆ™ä¸º$0$ æ‰€ä»¥çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š $dp[i][j]=dp[i-1][j]$ å½“$pre[i]-pre[i-j]$æˆ–è€…$j=1$æ—¶,$dp[i][j]=max(dp[i][j],pre[i]-pre[i-j])$ ","date":"2021-10-27","objectID":"/posts/cf1582e/:0:2","tags":["codeforces","dp"],"title":"Codeforces 1582E Pchelyonok and Segments","uri":"/posts/cf1582e/"},{"categories":["2021/10"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; typedef long long ll; const int maxn=1e5+5; const int maxm=450; int n,m; int a[maxn]; ll pre[maxn],st[maxn]; ll dp[maxn][maxm]; void init(){ for(int i=1;i\u003c=500;i++)st[i]=st[i-1]+i; } ll sub(int l,int r){ return pre[r]-pre[l-1]; } inline void solve(){ cin\u003e\u003en; m= upper_bound(st,st+500,n)-st-1; for(int i=n;i\u003e0;i--)cin\u003e\u003ea[i]; for(int i=1;i\u003c=n;i++)pre[i]=pre[i-1]+a[i]; for(int i=1;i\u003c=n;i++){ for(int j=1;j\u003c=m;j++){ if(i\u003cst[j])dp[i][j]=0; else{ dp[i][j]=dp[i-1][j]; if(j==1||sub(i-j+1,i)\u003cdp[i-j][j-1])dp[i][j]=max(dp[i][j],sub(i-j+1,i)); } } } for(int i=m;i\u003e0;i--){ if(dp[n][i]!=0){ cout\u003c\u003ci\u003c\u003cendl; return ; } } } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; cin\u003e\u003e__; init(); while(__--){ solve(); } return 0; } ","date":"2021-10-27","objectID":"/posts/cf1582e/:0:3","tags":["codeforces","dp"],"title":"Codeforces 1582E Pchelyonok and Segments","uri":"/posts/cf1582e/"},{"categories":["2021/10"],"content":"å°ç»“ dpè‹¦æ‰‹ï¼Œå¤§å¤§å°å°çš„bugæ”¹äº†ä¸€å¤© ","date":"2021-10-27","objectID":"/posts/cf1582e/:0:4","tags":["codeforces","dp"],"title":"Codeforces 1582E Pchelyonok and Segments","uri":"/posts/cf1582e/"},{"categories":["2021/10"],"content":"ä¼ é€é—¨ ","date":"2021-10-26","objectID":"/posts/cf1602d/:0:0","tags":["codeforces","bfs"],"title":"Codeforces 1602D Frog Traveler","uri":"/posts/cf1602d/"},{"categories":["2021/10"],"content":"é¢˜æ„ ä¸€åªé’è›™åœ¨äº•åº•åˆå§‹ä½ç½®ä¸º$n$ï¼Œæƒ³è·³åˆ°åœ°é¢ï¼ˆåœ°é¢ä¸º$0$ï¼‰ï¼Œå½“é’è›™åœ¨$i$æ—¶ï¼Œå¯ä»¥å‘ä¸Šè·³$0ï½a[i]$ä»»æ„é«˜åº¦ï¼Œå½“é’è›™è·³åˆ°ä½ç½®$j$æ—¶ï¼Œä¼šå‘ä¸‹æ»‘$b[i]$ï¼Œæ±‚è·³è‡³åœ°é¢æœ€å°‘éœ€è¦å‡ æ­¥ï¼Œå¹¶è¾“å‡ºè·¯å¾„ ","date":"2021-10-26","objectID":"/posts/cf1602d/:0:1","tags":["codeforces","bfs"],"title":"Codeforces 1602D Frog Traveler","uri":"/posts/cf1602d/"},{"categories":["2021/10"],"content":"æ€è·¯ æ˜¾ç„¶å½“é’è›™æƒ³å»å¾€ä½ç½®$j$æ—¶ï¼Œå…¶å¿…é¡»å»åˆ°ä½ç½®$i$ï¼Œä½ç½®$i$æ»¡è¶³$i+b[i]=j$ï¼Œå¯ä»¥å»ºç«‹ä¸¤ä¸ªæ•°ç»„ï¼Œ$hua[i]=j$ï¼Œ$yuan[j]=i$ï¼Œåœ¨bfsä¸­æˆ‘ä»¬åªè€ƒè™‘æœ€åæ»‘åˆ°çš„ä½ç½® é¦–å…ˆæˆ‘ä»¬è€ƒè™‘è£¸bfsï¼Œå¯¹äºä½ç½®$i$å¯ä»¥åˆ°è¾¾$hua[i-a[i],i-a[i]+1â€¦i-1,i]$ï¼Œç”±äºè¾¹æƒç›¸ç­‰ï¼Œæ‰€ä»¥æœ€çŸ­è·¯ä¸­æ¯ä¸€ä¸ªç‚¹æœ€å¤šåªä¼šè¢«è®¿é—®ä¸€æ¬¡ ä½†æ˜¯å½“æˆ‘ä»¬ä»¥è¿™ç§æ–¹å¼bfsæ—¶ï¼Œå¯¹äºä½ç½®$i$å’Œä½ç½®$j$ï¼Œ$hua[max(i-a[i],j-a[j])â€¦min(i,j)]$ä¼šè¢«é‡å¤åˆ¤æ–­ï¼Œå› æ­¤æˆ‘ä»¬åœ¨bfsçš„è¿‡ç¨‹ä¸­è®°å½•ä½ç½®$r$ä¸ºæˆ‘ä»¬ä»¥ç»è®¿é—®è¿‡çš„æœ€å°çš„è®¿é—®è¿‡çš„å€¼ï¼Œå³å¯¹äºä½ç½®$i$æˆ‘ä»¬åªéœ€è¦åˆ¤æ–­$hua[i-a[i],r]$ï¼Œç„¶åæ›´æ–°$r=min(r,i-a[i]-1)$ ","date":"2021-10-26","objectID":"/posts/cf1602d/:0:2","tags":["codeforces","bfs"],"title":"Codeforces 1602D Frog Traveler","uri":"/posts/cf1602d/"},{"categories":["2021/10"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; const int maxn=3e5+5; int n,m; int a[maxn],b[maxn]; int fa[maxn]; int hua[maxn]; int yuan[maxn]; bool vis[maxn]; vector\u003cint\u003e ans; inline void solve(){ scanf(\"%d\",\u0026n); n++; hua[n]=n; for(int i=2;i\u003c=n;i++)scanf(\"%d\",\u0026a[i]); for(int i=2;i\u003c=n;i++)scanf(\"%d\",\u0026b[i]); queue\u003cint\u003e q; fa[1]=-1; fa[n]=n; yuan[n]=n; hua[n]=n; vis[n]=1; q.push(n); int r=n-1; while(q.size()){ int t=q.front(); q.pop(); int l=t-a[t]; for(int i=l;i\u003c=r;i++){ int p=i+b[i]; if(vis[p])continue; fa[p]=t; hua[i]=p; yuan[p]=i; vis[p]=1; q.push(p); } if(l\u003c=r)r=l-1; } if(fa[1]==-1){ puts(\"-1\"); return ; } int p=1; while(p!=n){ ans.push_back(p); p=hua[p]; p=fa[p]; p=yuan[p]; } printf(\"%d\\n\",(int)ans.size()); for(int i=(int)ans.size()-1;i\u003e=0;i--)printf(\"%d \",ans[i]-1); puts(\"\"); } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; while(__--){ solve(); } return 0; } ","date":"2021-10-26","objectID":"/posts/cf1602d/:0:3","tags":["codeforces","bfs"],"title":"Codeforces 1602D Frog Traveler","uri":"/posts/cf1602d/"},{"categories":["2021/10"],"content":"æ€»ç»“ å¾ˆç®€å•çš„é¢˜ï¼Œä½†æ˜¯æ‰“æ¯”èµ›çš„æ—¶å€™ä¸€åº¦æƒ³åˆ°çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ï¼Œè¿˜æ˜¯æ²¡æœ‰æ›´å¤šçš„ä»å‰ªæã€æ€ç»´çš„è§’åº¦æƒ³é—®é¢˜ ","date":"2021-10-26","objectID":"/posts/cf1602d/:0:4","tags":["codeforces","bfs"],"title":"Codeforces 1602D Frog Traveler","uri":"/posts/cf1602d/"},{"categories":["2021/10"],"content":"ä¼ é€é—¨ ","date":"2021-10-21","objectID":"/posts/cf438d/:0:0","tags":["codeforces","segment tree"],"title":"Codeforces 438D The Child and Sequence","uri":"/posts/cf438d/"},{"categories":["2021/10"],"content":"é¢˜æ„ æ„é€ ä¸€ç§æ•°æ®ç»“æ„æ»¡è¶³ä»¥ä¸‹ä¸‰ç§æ“ä½œ è¾“å‡ºåŒºé—´$[l,r]$æ‰€æœ‰å…ƒç´ çš„å’Œ åŒºé—´$[l,r]$ä¸­æ‰€æœ‰å…ƒç´ å¯¹$x$å–æ¨¡ å°†å…ƒç´ $a[i]$èµ‹å€¼$x$ ","date":"2021-10-21","objectID":"/posts/cf438d/:0:1","tags":["codeforces","segment tree"],"title":"Codeforces 438D The Child and Sequence","uri":"/posts/cf438d/"},{"categories":["2021/10"],"content":"æ€è·¯ é¦–å…ˆä¸éš¾çœ‹å‡ºè¿™æ˜¯ä¸€ä¸ªçº¿æ®µæ ‘ è¿™é‡Œä¸»è¦è®¨è®ºç¬¬äºŒç§æ“ä½œï¼Œå¯¹ä»»æ„ä¸€ä¸ªå…ƒç´ $a[i]$ï¼Œå¦‚æœ$x\u003ea[i]$ï¼Œåˆ™æ“ä½œæ— æ„ä¹‰ã€‚æ˜¾ç„¶å¦‚æœæ“ä½œå¯¹$a[i]$æœ‰æ„ä¹‰ï¼Œåˆ™è¯¥æ“ä½œä¼šä½¿å¾—$a[i]$å‡åŠã€‚æ‰€ä»¥$a[i]$æœ€å¤šä¿®æ”¹$\\log a[i]$æ¬¡ï¼Œç”±æ­¤å¯è§å¿½ç•¥æ— æ•ˆæ“ä½œç„¶åæš´åŠ›æ›´æ–°å³å¯ã€‚ ","date":"2021-10-21","objectID":"/posts/cf438d/:0:2","tags":["codeforces","segment tree"],"title":"Codeforces 438D The Child and Sequence","uri":"/posts/cf438d/"},{"categories":["2021/10"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; typedef long long ll; const int maxn=2e5+5; int n,m; int a[maxn]; struct node{ int l,r; ll mx,sum; }tree[maxn\u003c\u003c2]; void pushup(int p){ tree[p].sum=tree[p\u003c\u003c1].sum+tree[p\u003c\u003c1|1].sum; tree[p].mx=max(tree[p\u003c\u003c1].mx,tree[p\u003c\u003c1|1].mx); } void build(int l,int r,int p=1){ tree[p].l=l,tree[p].r=r; if(l==r){ tree[p].sum=tree[p].mx=a[l]; return ; } int mid=(tree[p].l+tree[p].r)\u003e\u003e1; build(l,mid,p\u003c\u003c1); build(mid+1,r,p\u003c\u003c1|1); pushup(p); } void Mod(int l,int r,int md,int p=1){ if(tree[p].mx\u003cmd)return ; if(tree[p].l==tree[p].r){ tree[p].mx%=md; tree[p].sum=tree[p].mx; return ; } int mid=(tree[p].l+tree[p].r)\u003e\u003e1; if(l\u003c=mid\u0026\u0026tree[p\u003c\u003c1].mx\u003e=md)Mod(l,r,md,p\u003c\u003c1); if(r\u003emid\u0026\u0026tree[p\u003c\u003c1|1].mx\u003e=md)Mod(l,r,md,p\u003c\u003c1|1); pushup(p); } void Set(int k,int val,int p=1){ if(tree[p].l==tree[p].r){ tree[p].mx=val; tree[p].sum=val; return ; } int mid=(tree[p].l+tree[p].r)\u003e\u003e1; if(k\u003c=mid)Set(k,val,p\u003c\u003c1); else Set(k,val,p\u003c\u003c1|1); pushup(p); } ll query(int l,int r,int p=1){ if(tree[p].l\u003e=l\u0026\u0026tree[p].r\u003c=r)return tree[p].sum; int mid=(tree[p].l+tree[p].r)\u003e\u003e1; ll sum=0; if(l\u003c=mid)sum+=query(l,r,p\u003c\u003c1); if(r\u003emid)sum+=query(l,r,p\u003c\u003c1|1); return sum; } inline void solve(){ cin\u003e\u003en\u003e\u003em; for(int i=1;i\u003c=n;i++)cin\u003e\u003ea[i]; build(1,n); int opt; int u,v,w; while(m--){ cin\u003e\u003eopt; if(opt==1){ cin\u003e\u003eu\u003e\u003ev; cout\u003c\u003cquery(u,v)\u003c\u003cendl; }else if(opt==2){ cin\u003e\u003eu\u003e\u003ev\u003e\u003ew; if(w\u003c=tree[1].mx)Mod(u,v,w); }else{ cin\u003e\u003eu\u003e\u003ev; Set(u,v); } } } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; while(__--){ solve(); } return 0; } ","date":"2021-10-21","objectID":"/posts/cf438d/:0:3","tags":["codeforces","segment tree"],"title":"Codeforces 438D The Child and Sequence","uri":"/posts/cf438d/"},{"categories":["2021/10"],"content":"å°ç»“ åŠ¿èƒ½çº¿æ®µæ ‘çš„ç®€å•åº”ç”¨ ","date":"2021-10-21","objectID":"/posts/cf438d/:0:4","tags":["codeforces","segment tree"],"title":"Codeforces 438D The Child and Sequence","uri":"/posts/cf438d/"},{"categories":["2021/10"],"content":"ä¼ é€é—¨ ","date":"2021-10-13","objectID":"/posts/cf1042d/:0:0","tags":["codeforces","segment tree"],"title":"Codeforces 1042D Petya and Array","uri":"/posts/cf1042d/"},{"categories":["2021/10"],"content":"é¢˜æ„ è¾“å‡ºä¸€ä¸ªæ•°ç»„ä¸­æœ‰å¤šå°‘è¿ç»­çš„å­åºåˆ—ä¹‹å’Œå°äº$m$ ","date":"2021-10-13","objectID":"/posts/cf1042d/:0:1","tags":["codeforces","segment tree"],"title":"Codeforces 1042D Petya and Array","uri":"/posts/cf1042d/"},{"categories":["2021/10"],"content":"æ€è·¯ å…ˆè®¡ç®—å‡ºå‰ç¼€å’Œï¼Œæ˜¾ç„¶æˆ‘ä»¬éœ€è¦æ‰¾å‡ºæ»¡è¶³$sum_r-sum_l\u003ct$çš„ä¸¤ä¸ªä¸‹æ ‡ï¼Œå¯ä»¥è½¬åŒ–ä¸º$sum_r-t\u003csum_l$ ç„¶åå»ºç«‹å‰ç¼€å’Œçš„æƒå€¼çº¿æ®µæ ‘ï¼Œå¹¶åœ¨ä¿®æ”¹å‰æŸ¥è¯¢å¯¹äºå½“å‰ç‚¹$r$ï¼Œæœ‰å¤šå°‘å¤§äº$sum_r+t$çš„ç‚¹ï¼Œæ±‚å’Œå³å¯ å¦å¤–æ­¤é¢˜éœ€è¦ç¦»æ•£åŒ– ","date":"2021-10-13","objectID":"/posts/cf1042d/:0:2","tags":["codeforces","segment tree"],"title":"Codeforces 1042D Petya and Array","uri":"/posts/cf1042d/"},{"categories":["2021/10"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; typedef long long ll; const int maxn=4e5+5; ll n,m; ll a[maxn],num[maxn]; struct node{ int l,r; ll val; }tree[maxn\u003c\u003c2]; vector\u003cll\u003e v; inline int getid(ll x){ return lower_bound(v.begin(),v.end(),x)-v.begin()+1;}; void discrete(){ sort(v.begin(),v.end()); v.erase(unique(v.begin(),v.end()),v.end()); } void build(int l,int r,int o=1){ tree[o].l=l,tree[o].r=r; tree[o].val=0; if(tree[o].l==tree[o].r)return ; int mid=(tree[o].l+tree[o].r)\u003e\u003e1; build(l,mid,o\u003c\u003c1); build(mid+1,r,o\u003c\u003c1|1); } void pushup(int o){ tree[o].val=tree[o\u003c\u003c1].val+tree[o\u003c\u003c1|1].val; } void change(int lr,int o=1){ if(tree[o].l==tree[o].r){ tree[o].val++; return ; } int mid=(tree[o].l+tree[o].r)\u003e\u003e1; if(lr\u003c=mid)change(lr,o\u003c\u003c1); else change(lr,o\u003c\u003c1|1); pushup(o); } ll query(int l,int r,int o=1){ if(l\u003c=tree[o].l\u0026\u0026r\u003e=tree[o].r)return tree[o].val; int mid=(tree[o].l+tree[o].r)\u003e\u003e1; ll sum=0; if(l\u003c=mid)sum+=query(l,r,o\u003c\u003c1); if(r\u003emid)sum+=query(l,r,o\u003c\u003c1|1); return sum; } inline void solve(){ cin\u003e\u003en\u003e\u003em; v.push_back(0); for(int i=1;i\u003c=n;i++){ cin\u003e\u003ea[i]; a[i]+=a[i-1]; v.push_back(a[i]); } for(int i=1;i\u003c=n;i++)v.push_back(a[i]-m+1); discrete(); for(int i=1;i\u003c=n;i++)num[i]=getid(a[i]); build(1,v.size()); change(getid(0)); ll ans=0; for(int i=1;i\u003c=n;i++){ int tmp=query(getid(a[i]-m+1),v.size()); ans+=tmp; change(num[i]); } cout\u003c\u003cans\u003c\u003cendl; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; while(__--){ solve(); } return 0; } ","date":"2021-10-13","objectID":"/posts/cf1042d/:0:3","tags":["codeforces","segment tree"],"title":"Codeforces 1042D Petya and Array","uri":"/posts/cf1042d/"},{"categories":["2021/10"],"content":"å°ç»“ æƒå€¼çº¿æ®µæ ‘å’Œå‰ç¼€å’Œçš„ç®€å•åº”ç”¨ï¼Œç é‡æœ‰ç‚¹å¤§ï¼Œç»†èŠ‚å‡ºé”™æ‰¾bugè¿˜æ˜¯æ‰¾äº†å¾ˆä¹… ","date":"2021-10-13","objectID":"/posts/cf1042d/:0:4","tags":["codeforces","segment tree"],"title":"Codeforces 1042D Petya and Array","uri":"/posts/cf1042d/"},{"categories":["2021/10"],"content":"ä¼ é€é—¨ step1 ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:0:0","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"A. Suffix Array - 1 ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:1:0","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"é¢˜æ„ æ±‚åç¼€æ•°ç»„ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:1:1","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"æ€è·¯ ç›´æ¥ä¸Šæ¿å­ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:1:2","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; const int maxn=1e5+5; const int maxm=1e9; int n,m; int N,M,rk[maxn],sa[maxn],tp[maxn],tax[maxn],px[maxn],ht[maxn]; char s[maxn]; void ssort(){ for(int i=0;i\u003c=M;i++)tax[i]=0; for(int i=1;i\u003c=N;i++)tax[px[i]=rk[tp[i]]]++; for(int i=1;i\u003c=M;i++)tax[i]+=tax[i-1]; for(int i=N;i\u003e0;i--)sa[tax[px[i]]--]=tp[i]; } inline bool cmp(int x,int y,int w){ return tp[x]==tp[y]\u0026\u0026tp[x+w]==tp[y+w]; } void SuffixArray(){ M=300; N=strlen(s+1); memset(rk,0,sizeof rk); for(int i=1;i\u003c=N;i++)rk[i]=s[i],tp[i]=i; ssort(); for(int w=1,p=0;p\u003cN;M=p,w\u003c\u003c=1){ p=0; for(int i=1;i\u003c=w;i++)tp[++p]=N-w+i; for(int i=1;i\u003c=N;i++)if(sa[i]\u003ew)tp[++p]=sa[i]-w; ssort(); memcpy(tp,rk,sizeof rk); rk[sa[1]]=p=1; for(int i=2;i\u003c=N;i++)rk[sa[i]]=cmp(sa[i],sa[i-1],w)?p:++p; } } char tmp[maxn]; inline void solve(){ cin\u003e\u003e(tmp+1); n=strlen(tmp+1); for(int i=1;i\u003c=n;i++)s[i]=tmp[i]; s[n+1]='$'; SuffixArray(); for(int i=1;i\u003c=N;i++)cout\u003c\u003csa[i]-1\u003c\u003c\" \"; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; while(__--){ solve(); } return 0; } step2 ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:1:3","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"A. Suffix Array - 2 ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:2:0","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"é¢˜æ„ æ›´å¿«çš„æ±‚åç¼€æ•°ç»„ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:2:1","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"æ€è·¯ åŒæ ·ç›´æ¥ä¸Šæ¿å­ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:2:2","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; const int maxn=1e5+5; const int maxm=1e9; int n,m; int N,M,rk[maxn],sa[maxn],tp[maxn],tax[maxn],px[maxn],ht[maxn]; char s[maxn]; void ssort(){ for(int i=0;i\u003c=M;i++)tax[i]=0; for(int i=1;i\u003c=N;i++)tax[px[i]=rk[tp[i]]]++; for(int i=1;i\u003c=M;i++)tax[i]+=tax[i-1]; for(int i=N;i\u003e0;i--)sa[tax[px[i]]--]=tp[i]; } inline bool cmp(int x,int y,int w){ return tp[x]==tp[y]\u0026\u0026tp[x+w]==tp[y+w]; } void SuffixArray(){ M=300; N=strlen(s+1); memset(rk,0,sizeof rk); for(int i=1;i\u003c=N;i++)rk[i]=s[i],tp[i]=i; ssort(); for(int w=1,p=0;p\u003cN;M=p,w\u003c\u003c=1){ p=0; for(int i=1;i\u003c=w;i++)tp[++p]=N-w+i; for(int i=1;i\u003c=N;i++)if(sa[i]\u003ew)tp[++p]=sa[i]-w; ssort(); memcpy(tp,rk,sizeof rk); rk[sa[1]]=p=1; for(int i=2;i\u003c=N;i++)rk[sa[i]]=cmp(sa[i],sa[i-1],w)?p:++p; } } char tmp[maxn]; inline void solve(){ cin\u003e\u003e(tmp+1); n=strlen(tmp+1); for(int i=1;i\u003c=n;i++)s[i]=tmp[i]; s[n+1]='$'; SuffixArray(); for(int i=1;i\u003c=N;i++)cout\u003c\u003csa[i]-1\u003c\u003c\" \"; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; while(__--){ solve(); } return 0; } step3 ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:2:3","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"A. Substring Search ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:3:0","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"é¢˜æ„ ç»™å®šå­—ç¬¦ä¸²$t$ï¼Œ$n$æ¬¡è¯¢é—®ï¼Œç»™å®šå­—ç¬¦ä¸²$s_i$æ˜¯å¦ä¸º$t$çš„å­ä¸² ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:3:1","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"æ€è·¯ å¾—å‡ºåç¼€æ•°ç»„ä¹‹åï¼Œåœ¨åç¼€æ•°ç»„ä¸­äºŒåˆ†æŸ¥æ‰¾å³å¯ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:3:2","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; const int maxn=3e5+5; int n,m; int N,M,rk[maxn],sa[maxn],tp[maxn],tax[maxn],px[maxn],ht[maxn]; char s[maxn]; void ssort(){ for(int i=0;i\u003c=M;i++)tax[i]=0; for(int i=1;i\u003c=N;i++)tax[px[i]=rk[tp[i]]]++; for(int i=1;i\u003c=M;i++)tax[i]+=tax[i-1]; for(int i=N;i\u003e0;i--)sa[tax[px[i]]--]=tp[i]; } inline bool cmp(int x,int y,int w){ return tp[x]==tp[y]\u0026\u0026tp[x+w]==tp[y+w]; } void SuffixArray(){ M=300; N=strlen(s+1); memset(rk,0,sizeof rk); for(int i=1;i\u003c=N;i++)rk[i]=s[i],tp[i]=i; ssort(); for(int w=1,p=0;p\u003cN;M=p,w\u003c\u003c=1){ p=0; for(int i=1;i\u003c=w;i++)tp[++p]=N-w+i; for(int i=1;i\u003c=N;i++)if(sa[i]\u003ew)tp[++p]=sa[i]-w; ssort(); memcpy(tp,rk,sizeof rk); rk[sa[1]]=p=1; for(int i=2;i\u003c=N;i++)rk[sa[i]]=cmp(sa[i],sa[i-1],w)?p:++p; } } char tmp[maxn]; int len; bool check(int x){ x=sa[x]; for(int i=0;i\u003cmin(len,N-x+1);i++){ if(s[x+i]\u003etmp[i+1])return 1; else if(s[x+i]\u003ctmp[i+1])return 0; } return len\u003c=N-x+1; } int bsearch_1(int l,int r){ len=strlen(tmp+1); while(l\u003cr){ int mid=(l+r)\u003e\u003e1; if(check(mid))r=mid; else l=mid+1; } l=sa[l]; if(len\u003eN-l+1)return 0; for(int i=0;i\u003cmin(len,N-l+1);i++){ if(s[l+i]!=tmp[i+1]){ return 0; } } return 1; } inline void solve(){ cin\u003e\u003e(s+1)\u003e\u003en; SuffixArray(); for(int i=1;i\u003c=n;i++){ cin\u003e\u003e(tmp+1); if(bsearch_1(1,N))cout\u003c\u003c\"Yes\"\u003c\u003cendl; else cout\u003c\u003c\"No\"\u003c\u003cendl; } } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; while(__--){ solve(); } return 0; } ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:3:3","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"B. Counting Substrings ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:4:0","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"é¢˜æ„ ç»™å®šå­—ç¬¦ä¸²$t$ï¼Œ$n$æ¬¡è¯¢é—®ï¼Œç»™å®šå­—ç¬¦ä¸²$s_i$åœ¨$t$ä¸­å‡ºç°çš„æ¬¡æ•° ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:4:1","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"æ€è·¯ äºŒåˆ†æŸ¥æ‰¾æ‰¾å‡ºç¬¬ä¸€ä¸ªå­—å…¸åºæ¯”$s_i$å°çš„å’Œç¬¬ä¸€ä¸ªæ¯”$s_i$å¤§çš„å³å¯ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:4:2","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; const int maxn=3e5+5; int n,m; int N,M,rk[maxn],sa[maxn],tp[maxn],tax[maxn],px[maxn],ht[maxn]; char s[maxn]; void ssort(){ for(int i=0;i\u003c=M;i++)tax[i]=0; for(int i=1;i\u003c=N;i++)tax[px[i]=rk[tp[i]]]++; for(int i=1;i\u003c=M;i++)tax[i]+=tax[i-1]; for(int i=N;i\u003e0;i--)sa[tax[px[i]]--]=tp[i]; } inline bool cmp(int x,int y,int w){ return tp[x]==tp[y]\u0026\u0026tp[x+w]==tp[y+w]; } void SuffixArray(){ M=300; N=strlen(s+1); memset(rk,0,sizeof rk); for(int i=1;i\u003c=N;i++)rk[i]=s[i],tp[i]=i; ssort(); for(int w=1,p=0;p\u003cN;M=p,w\u003c\u003c=1){ p=0; for(int i=1;i\u003c=w;i++)tp[++p]=N-w+i; for(int i=1;i\u003c=N;i++)if(sa[i]\u003ew)tp[++p]=sa[i]-w; ssort(); memcpy(tp,rk,sizeof rk); rk[sa[1]]=p=1; for(int i=2;i\u003c=N;i++)rk[sa[i]]=cmp(sa[i],sa[i-1],w)?p:++p; } } char tmp[maxn]; int len; bool check1(int x){ string a(tmp+1),b; x=sa[x]; for(int i=0;i\u003cmin(N-x+1,len);i++)b.push_back(s[x+i]); return b\u003e=a; } int bsearch_1(int l,int r){ while(l\u003cr){ int mid=(l+r)\u003e\u003e1; if(check1(mid))r=mid; else l=mid+1; } return l; } bool check2(int x){ string a(tmp+1),b; x=sa[x]; for(int i=0;i\u003cmin(N-x+1,len);i++)b.push_back(s[x+i]); return b\u003ea; } int bsearch_2(int l,int r){ while(l\u003cr){ int mid=(l+r+1)\u003e\u003e1; if(check2(mid))r=mid-1; else l=mid; } return l; } inline void solve(){ cin\u003e\u003e(s+1)\u003e\u003en; SuffixArray(); for(int i=1;i\u003c=n;i++){ cin\u003e\u003e(tmp+1); len=strlen(tmp+1); int ans1=bsearch_2(1,N),ans2=bsearch_1(1,N); string a(tmp+1),b; for(int i=0;i\u003cmin(N-sa[ans2]+1,len);i++)b.push_back(s[sa[ans2]+i]); if(a!=b)cout\u003c\u003c0\u003c\u003cendl; else cout\u003c\u003cans1-ans2+1\u003c\u003cendl; } } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; while(__--){ solve(); } return 0; } step4 ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:4:3","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"A. Suffix Array and LCP ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:5:0","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"é¢˜æ„ æ±‚åç¼€æ•°ç»„ä»¥åŠ$height$æ•°ç»„ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:5:1","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"æ€è·¯ ç›´æ¥ä¸Šæ¿å­ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:5:2","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; const int maxn=3e5+5; int n,m; int N,M,rk[maxn],sa[maxn],tp[maxn],tax[maxn],px[maxn],ht[maxn]; char s[maxn]; void ssort(){ for(int i=0;i\u003c=M;i++)tax[i]=0; for(int i=1;i\u003c=N;i++)tax[px[i]=rk[tp[i]]]++; for(int i=1;i\u003c=M;i++)tax[i]+=tax[i-1]; for(int i=N;i\u003e0;i--)sa[tax[px[i]]--]=tp[i]; } inline bool cmp(int x,int y,int w){ return tp[x]==tp[y]\u0026\u0026tp[x+w]==tp[y+w]; } void SuffixArray(){ M=300; N=strlen(s+1); memset(rk,0,sizeof rk); for(int i=1;i\u003c=N;i++)rk[i]=s[i]+1,tp[i]=i; ssort(); for(int w=1,p=0;p\u003cN;M=p,w\u003c\u003c=1){ p=0; for(int i=1;i\u003c=w;i++)tp[++p]=N-w+i; for(int i=1;i\u003c=N;i++)if(sa[i]\u003ew)tp[++p]=sa[i]-w; ssort(); memcpy(tp,rk,sizeof rk); rk[sa[1]]=p=1; for(int i=2;i\u003c=N;i++)rk[sa[i]]=cmp(sa[i],sa[i-1],w)?p:++p; } } void Height(){ int j,k=0; for(int i=1;i\u003c=N;i++){ if(k)k--; int j=sa[rk[i]-1]; while(s[i+k]==s[j+k])k++; ht[rk[i]]=k; } } inline void solve(){ string str; cin\u003e\u003estr; str.push_back('$'); for(int i=0;i\u003cstr.size();i++)s[i+1]=str[i]; SuffixArray(); for(int i=1;i\u003c=N;i++)cout\u003c\u003csa[i]-1\u003c\u003c\" \"; cout\u003c\u003cendl; Height(); for(int i=2;i\u003c=N;i++)cout\u003c\u003cht[i]\u003c\u003c\" \"; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; while(__--){ solve(); } return 0; } step5 ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:5:3","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"A. Number of Different Substrings ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:6:0","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"é¢˜æ„ å¯¹äºç»™å®šå­—ç¬¦ä¸²$s$ï¼Œæ±‚å‡ºå…¶ä¸åŒå­ä¸²çš„æ•°é‡ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:6:1","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"æ€è·¯ å¯¹äºåç¼€$sa[i]$å’Œåç¼€$sa[i+1]$ï¼Œåç¼€$sa[i+1]$çš„è´¡çŒ®ä¸ºå…¶é•¿åº¦å‡å»ä¸åç¼€$sa[i]$éƒ¨åˆ†ï¼Œæ‰€ä»¥ä¸åŒå­ä¸²çš„æ•°é‡ä¸º$n(n-1)/2-\\sum_{i=1}^n height[i]$ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:6:2","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; typedef long long ll; const int maxn=4e5+5; int n,m; int N,M,rk[maxn],sa[maxn],tp[maxn],tax[maxn],px[maxn],ht[maxn]; char s[maxn]; void ssort(){ for(int i=0;i\u003c=M;i++)tax[i]=0; for(int i=1;i\u003c=N;i++)tax[px[i]=rk[tp[i]]]++; for(int i=1;i\u003c=M;i++)tax[i]+=tax[i-1]; for(int i=N;i\u003e0;i--)sa[tax[px[i]]--]=tp[i]; } inline bool cmp(int x,int y,int w){ return tp[x]==tp[y]\u0026\u0026tp[x+w]==tp[y+w]; } void SuffixArray(){ M=75; N=strlen(s+1); memset(rk,0,sizeof rk); for(int i=1;i\u003c=N;i++)rk[i]=s[i]-'0'+1,tp[i]=i; ssort(); for(int w=1,p=0;p\u003cN;M=p,w\u003c\u003c=1){ p=0; for(int i=1;i\u003c=w;i++)tp[++p]=N-w+i; for(int i=1;i\u003c=N;i++)if(sa[i]\u003ew)tp[++p]=sa[i]-w; ssort(); memcpy(tp,rk,sizeof rk); rk[sa[1]]=p=1; for(int i=2;i\u003c=N;i++)rk[sa[i]]=cmp(sa[i],sa[i-1],w)?p:++p; } } void Height(){ int j,k=0; for(int i=1;i\u003c=N;i++){ if(k)k--; int j=sa[rk[i]-1]; while(s[i+k]==s[j+k])k++; ht[rk[i]]=k; } } inline void solve(){ cin\u003e\u003e(s+1); SuffixArray(); Height(); ll ans=0; for(int i=1;i\u003c=N;i++)ans+=(ll)sa[i]-ht[i]; cout\u003c\u003cans\u003c\u003cendl; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; while(__--){ solve(); } return 0; } ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:6:3","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"B. Longest Common Substring ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:7:0","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"é¢˜æ„ ç»™å®šå­—ç¬¦ä¸²$s$å’Œ$t$ï¼Œè¾“å‡ºå…¶æœ€é•¿å…¬å…±å­ä¸² ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:7:1","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"æ€è·¯ é¦–å…ˆå°†ä¸¤ä¸ªå­—ç¬¦ä¸²æ‹¼æ¥åœ¨ä¸€èµ·ç”¨$åˆ†éš” å¾ˆå®¹æ˜“æƒ³åˆ°ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­ä»¥æœ€é•¿å…¬å…±å­ä¸²å‘³é¦–çš„åç¼€åœ¨åç¼€æ•°ç»„ä¸­å¿…ç„¶ç›¸é‚»ï¼Œæ‰€ä»¥åœ¨$height$æ•°ç»„ä¸­æ‰¾å‡ºä¸¤ä¸ªåç¼€æ¥è‡ªä¸åŒçš„å­—ç¬¦ä¸²ä¸”å€¼æœ€å¤§çš„ä½ç½®å³å¯ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:7:2","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; const int maxn=4e5+5; int n,m; int N,M,rk[maxn],sa[maxn],tp[maxn],tax[maxn],px[maxn],ht[maxn]; char s[maxn]; void ssort(){ for(int i=0;i\u003c=M;i++)tax[i]=0; for(int i=1;i\u003c=N;i++)tax[px[i]=rk[tp[i]]]++; for(int i=1;i\u003c=M;i++)tax[i]+=tax[i-1]; for(int i=N;i\u003e0;i--)sa[tax[px[i]]--]=tp[i]; } inline bool cmp(int x,int y,int w){ return tp[x]==tp[y]\u0026\u0026tp[x+w]==tp[y+w]; } void SuffixArray(){ M=300; N=strlen(s+1); memset(rk,0,sizeof rk); for(int i=1;i\u003c=N;i++)rk[i]=s[i]+1,tp[i]=i; ssort(); for(int w=1,p=0;p\u003cN;M=p,w\u003c\u003c=1){ p=0; for(int i=1;i\u003c=w;i++)tp[++p]=N-w+i; for(int i=1;i\u003c=N;i++)if(sa[i]\u003ew)tp[++p]=sa[i]-w; ssort(); memcpy(tp,rk,sizeof rk); rk[sa[1]]=p=1; for(int i=2;i\u003c=N;i++)rk[sa[i]]=cmp(sa[i],sa[i-1],w)?p:++p; } } void Height(){ int j,k=0; for(int i=1;i\u003c=N;i++){ if(k)k--; int j=sa[rk[i]-1]; while(s[i+k]==s[j+k])k++; ht[rk[i]]=k; } } inline void solve(){ string s1,s2; cin\u003e\u003es1\u003e\u003es2; int len1=s1.size(),len2=s2.size(); s1+='$'; s1+=s2; for(int i=0;i\u003cs1.size();i++)s[i+1]=s1[i]; SuffixArray(); Height(); int ans=1; for(int i=2;i\u003c=N;i++){ if(sa[i]\u003c=len1\u0026\u0026sa[i-1]\u003elen1+1\u0026\u0026ht[ans]\u003cht[i])ans=i; if(sa[i-1]\u003c=len1\u0026\u0026sa[i]\u003elen1+1\u0026\u0026ht[ans]\u003cht[i])ans=i; } for(int i=0;i\u003cht[ans];i++)cout\u003c\u003cs[sa[ans]+i]; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; while(__--){ solve(); } return 0; } ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:7:3","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"C. Sorting Substrings ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:8:0","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"é¢˜æ„ ç»™å®šå­—ç¬¦ä¸²$s$ä»¥åŠå…¶$n$ä¸ªå­ä¸²ï¼Œå°†å…¶æ’åºåè¾“å‡ºï¼ˆå­ä¸²å‡ä»¥$l,r$çš„æ–¹å¼ç»™å‡ºä»¥åŠè¾“å‡ºï¼‰ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:8:1","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"æ€è·¯ å¯¹äºå­ä¸²$[l_i,r_i]$å’Œ$[l_j,r_j]$ï¼Œå½“$lcp(l_i,l_j) \\geqslant min(r_i-l_i+1,r_j-l_j+1)$ï¼Œåˆ™åªéœ€è¦æ¯”è¾ƒå…¶é•¿åº¦å³å¯ï¼Œå¦åˆ™åˆ™æ¯”è¾ƒ$rank[l_i]$å’Œ$rank[l_j]$ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:8:2","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; #define x first #define y second typedef pair\u003cint,int\u003e P; const int maxn=4e5+5; int n,m; int N,M,rk[maxn],sa[maxn],tp[maxn],tax[maxn],px[maxn],ht[maxn]; char s[maxn]; void ssort(){ for(int i=0;i\u003c=M;i++)tax[i]=0; for(int i=1;i\u003c=N;i++)tax[px[i]=rk[tp[i]]]++; for(int i=1;i\u003c=M;i++)tax[i]+=tax[i-1]; for(int i=N;i\u003e0;i--)sa[tax[px[i]]--]=tp[i]; } inline bool cmp(int x,int y,int w){ return tp[x]==tp[y]\u0026\u0026tp[x+w]==tp[y+w]; } void SuffixArray(){ M=300; N=strlen(s+1); memset(rk,0,sizeof rk); for(int i=1;i\u003c=N;i++)rk[i]=s[i]+1,tp[i]=i; ssort(); for(int w=1,p=0;p\u003cN;M=p,w\u003c\u003c=1){ p=0; for(int i=1;i\u003c=w;i++)tp[++p]=N-w+i; for(int i=1;i\u003c=N;i++)if(sa[i]\u003ew)tp[++p]=sa[i]-w; ssort(); memcpy(tp,rk,sizeof rk); rk[sa[1]]=p=1; for(int i=2;i\u003c=N;i++)rk[sa[i]]=cmp(sa[i],sa[i-1],w)?p:++p; } } void Height(){ int j,k=0; for(int i=1;i\u003c=N;i++){ if(k)k--; int j=sa[rk[i]-1]; while(s[i+k]==s[j+k])k++; ht[rk[i]]=k; } } int st[maxn][30],plg[maxn]; void ST_pre(){ plg[1]=0; for(int i=2;i\u003c=N;i++)plg[i]=plg[i/2]+1; for(int i=1;i\u003c=N;i++)st[i][0]=ht[i]; for(int j=1;j\u003c=plg[N];j++){ for(int i=1;i\u003c=N-(1\u003c\u003cj)+1;i++){ st[i][j]=min(st[i][j-1],st[i+(1\u003c\u003c(j-1))][j-1]); } } } int ST_query(int l,int r){ int k=plg[r-l+1]; return min(st[l][k],st[r-(1\u003c\u003ck)+1][k]); } int lcp(int a,int b){//ç¬¬aä¸ªåç¼€ä¸ç¬¬bä¸ªåç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€ a=rk[a],b=rk[b]; if(a\u003eb)swap(a,b); return ST_query(a+1,b); } vector\u003cP\u003e v; bool f(P a,P b){ int lena=a.y-a.x+1; int lenb=b.y-b.x+1; int len=lcp(a.x,b.x); if(a.x==b.x)len=inf; if(len\u003e=min(lena,lenb)){ if(lena\u003clenb)return 1; else if(lena\u003elenb)return 0; else if(a.x\u003cb.x)return 1; else if(a.x\u003eb.x)return 0; else return a.y\u003cb.y; } return rk[a.x]\u003crk[b.x]; } inline void solve(){ cin\u003e\u003e(s+1); SuffixArray(); Height(); ST_pre(); cin\u003e\u003en; int a,b; for(int i=0;i\u003cn;i++){ cin\u003e\u003ea\u003e\u003eb; v.push_back(P(a,b)); } sort(v.begin(),v.end(),f); for(int i=0;i\u003cn;i++)cout\u003c\u003cv[i].x\u003c\u003c\" \"\u003c\u003cv[i].y\u003c\u003cendl; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; while(__--){ solve(); } return 0; } ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:8:3","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"D. Borders ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:9:0","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"é¢˜æ„ å¦‚æœä¸€ä¸ªå­—ç¬¦ä¸²åŒæ—¶æ˜¯å¦ä¸€ä¸ªå­—ç¬¦ä¸²çš„å‰ç¼€å’Œåç¼€ï¼Œåˆ™ç§°è¿™ä¸ªå­—ç¬¦ä¸²ä¸ºå¦ä¸€ä¸ªå­—ç¬¦ä¸²çš„$border$ å¯¹äºç»™å®šä¸²$s$ï¼Œè¾“å‡ºå…¶æ‰€æœ‰å­ä¸²çš„$border$æ•°é‡ä¹‹å’Œ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:9:1","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"æ€è·¯ å¯¹äºåç¼€$i$å’Œåç¼€$j$è¿™å¯¹åç¼€çš„è´¡çŒ®ä¸º$lcp(i,j)$ï¼Œå› æ­¤ç­”æ¡ˆä¸º$\\sum_{i=1}^n \\sum_{j=i}^nlcp(i,j)$ è€Œ$lcp(i,j)$æœ¬è´¨ä¸º$min{height[i+1â€¦j]}$ å› æ­¤é—®é¢˜å˜æˆäº†æ±‚heightæ•°ç»„çš„å­æ•°ç»„æœ€å°å€¼ä¹‹å’Œï¼Œç”¨å•è°ƒæ ˆå’Œdpä¼˜åŒ–è¿™ä¸ªè¿‡ç¨‹ æ„é€ é€’å¢çš„å•è°ƒæ ˆï¼Œå®šä¹‰$sum[i]$ä¸ºä»¥$i$ä¸ºå³ç«¯ç‚¹çš„åŒºé—´æœ€å°å€¼ä¹‹å’Œï¼Œå¯¹äº$i$æˆ‘ä»¬æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ¯”$i$å°çš„ä½ç½®$j$ï¼Œ$sum[i]$ç”±ä¸¤éƒ¨åˆ†æ„æˆï¼Œå·¦ç«¯ç‚¹åœ¨$j$çš„å³ä¾§çš„å­æ•°ç»„ä¹‹å’Œä¸º$(i-j)*height[i]$ï¼Œè€Œå·¦ç«¯ç‚¹åœ¨$j$çš„å·¦ä¾§çš„å­—æ•°ç»„ä¹‹å’Œä¸º$sum[j]$ï¼Œæ‰€ä»¥$sum[i]=(i-j)*height[i]+sum[j]$ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:9:2","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; typedef long long ll; const int maxn=4e5+5; int n,m; int N,M,rk[maxn],sa[maxn],tp[maxn],tax[maxn],px[maxn],ht[maxn]; char s[maxn]; void ssort(){ for(int i=0;i\u003c=M;i++)tax[i]=0; for(int i=1;i\u003c=N;i++)tax[px[i]=rk[tp[i]]]++; for(int i=1;i\u003c=M;i++)tax[i]+=tax[i-1]; for(int i=N;i\u003e0;i--)sa[tax[px[i]]--]=tp[i]; } inline bool cmp(int x,int y,int w){ return tp[x]==tp[y]\u0026\u0026tp[x+w]==tp[y+w]; } void SuffixArray(){ M=300; N=strlen(s+1); memset(rk,0,sizeof rk); for(int i=1;i\u003c=N;i++)rk[i]=s[i]+1,tp[i]=i; ssort(); for(int w=1,p=0;p\u003cN;M=p,w\u003c\u003c=1){ p=0; for(int i=1;i\u003c=w;i++)tp[++p]=N-w+i; for(int i=1;i\u003c=N;i++)if(sa[i]\u003ew)tp[++p]=sa[i]-w; ssort(); memcpy(tp,rk,sizeof rk); rk[sa[1]]=p=1; for(int i=2;i\u003c=N;i++)rk[sa[i]]=cmp(sa[i],sa[i-1],w)?p:++p; } } void Height(){ int j,k=0; for(int i=1;i\u003c=N;i++){ if(k)k--; int j=sa[rk[i]-1]; while(s[i+k]==s[j+k])k++; ht[rk[i]]=k; } } stack\u003cint\u003e st; ll sum[maxn]; inline void solve(){ cin\u003e\u003e(s+1); SuffixArray(); Height(); ll ans=0; for(int i=1;i\u003c=N;i++)ans+=i; for(ll i=2;i\u003c=N;i++){ while(!st.empty()\u0026\u0026ht[st.top()]\u003e=ht[i])st.pop(); sum[i]=st.empty()?(i-1)*ht[i]:(i-st.top())*ht[i]+sum[st.top()]; st.push(i); } for(int i=2;i\u003c=N;i++)ans+=sum[i]; cout\u003c\u003cans\u003c\u003cendl; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; while(__--){ solve(); } return 0; } ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:9:3","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"E. Refrain ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:10:0","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"é¢˜æ„ å¯¹ç»™å®šå­—ç¬¦ä¸²$s$ï¼Œæ‰¾åˆ°å­ä¸²$t$ï¼Œ$t$æ»¡è¶³å‡ºç°æ¬¡æ•°ä¸å­—ç¬¦ä¸²é•¿åº¦çš„ä¹˜ç§¯åœ¨æ‰€æœ‰å­ä¸²ä¸­æœ€å¤§ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:10:1","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"æ€è·¯ å¯¹äºä»»æ„å­ä¸²ä¸ºé¦–çš„åç¼€å…¶åœ¨åç¼€æ•°ç»„ä¸­å‡ºç°éƒ½æ˜¯è¿ç»­çš„ï¼Œè¯¥é—®é¢˜å¯ä»¥åŒ–ç®€ä¸ºåœ¨$height$æ•°ç»„ä¸­æ±‚æœ€å¤§çŸ©å½¢ åˆ©ç”¨å•è°ƒæ ˆæ‰¾å‡ºå¯¹äºä»»æ„$height[i]$å·¦ä¾§å’Œå³ä¾§ç¬¬ä¸€ä¸ªæ¯”$height[i]$å°çš„ä½ç½®è®°ä¸º$pre[i]$å’Œ$nxt[i]$ï¼Œ$height[i]*(nxt[i]-pre[i])$å³ä¸ºä»¥$height[i]$ä¸ºé«˜å®½åº¦æœ€å®½çš„çŸ©å½¢ï¼Œæ±‚å‡ºæœ€å€¼å³å¯ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:10:2","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; typedef long long ll; const int maxn=4e5+5; int n,m; int N,M,rk[maxn],sa[maxn],tp[maxn],tax[maxn],px[maxn],ht[maxn]; char s[maxn]; void ssort(){ for(int i=0;i\u003c=M;i++)tax[i]=0; for(int i=1;i\u003c=N;i++)tax[px[i]=rk[tp[i]]]++; for(int i=1;i\u003c=M;i++)tax[i]+=tax[i-1]; for(int i=N;i\u003e0;i--)sa[tax[px[i]]--]=tp[i]; } inline bool cmp(int x,int y,int w){ return tp[x]==tp[y]\u0026\u0026tp[x+w]==tp[y+w]; } void SuffixArray(){ M=300; N=strlen(s+1); memset(rk,0,sizeof rk); for(int i=1;i\u003c=N;i++)rk[i]=s[i]+1,tp[i]=i; ssort(); for(int w=1,p=0;p\u003cN;M=p,w\u003c\u003c=1){ p=0; for(int i=1;i\u003c=w;i++)tp[++p]=N-w+i; for(int i=1;i\u003c=N;i++)if(sa[i]\u003ew)tp[++p]=sa[i]-w; ssort(); memcpy(tp,rk,sizeof rk); rk[sa[1]]=p=1; for(int i=2;i\u003c=N;i++)rk[sa[i]]=cmp(sa[i],sa[i-1],w)?p:++p; } } void Height(){ int j,k=0; for(int i=1;i\u003c=N;i++){ if(k)k--; int j=sa[rk[i]-1]; while(s[i+k]==s[j+k])k++; ht[rk[i]]=k; } } stack\u003cint\u003e st; ll pre[maxn],nxt[maxn]; inline void solve(){ cin\u003e\u003en\u003e\u003em; int c; string ss; for(int i=1;i\u003c=n;i++){ cin\u003e\u003ec; s[i]='a'+c; } SuffixArray(); Height(); ll ans=N; for(int i=2;i\u003c=N;i++){ while(st.size()\u0026\u0026ht[i]\u003c=ht[st.top()])st.pop(); pre[i]=st.size()?st.top():1; st.push(i); } while(st.size())st.pop(); for(int i=N;i\u003e=2;i--){ while(st.size()\u0026\u0026ht[i]\u003c=ht[st.top()])st.pop(); nxt[i]=st.size()?st.top():N+1; st.push(i); } int len=0,id=0; for(int i=2;i\u003c=N;i++){ if((nxt[i]-pre[i])*ht[i]\u003eans||((nxt[i]-pre[i])*ht[i]==ans\u0026\u0026(nxt[i]-pre[i])\u003clen)){ ans=(nxt[i]-pre[i])*ht[i]; len=nxt[i]-pre[i]; id=i; } } if(ans==N){ cout\u003c\u003cN\u003c\u003cendl; cout\u003c\u003cN\u003c\u003cendl; for(int i=1;i\u003c=N;i++)cout\u003c\u003cs[i]-'a'\u003c\u003c\" \"; return ; } cout\u003c\u003cans\u003c\u003cendl; cout\u003c\u003cans/len\u003c\u003cendl; for(int i=0;i\u003cans/len;i++)cout\u003c\u003cs[sa[id]+i]-'a'\u003c\u003c\" \"; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; while(__--){ solve(); } return 0; } ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:10:3","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"F. Periodic Substring ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:11:0","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"é¢˜æ„ æ±‚å‡ºé‡å¤æ¬¡æ•°æœ€å¤šçš„è¿ç»­å­ä¸² ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:11:1","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"æ€è·¯ æšä¸¾å­ä¸²é•¿åº¦ä¸º$i$ï¼Œå¦‚æœå­ä¸²ä¸­å¾ªç¯èŠ‚é‡å¤æ¬¡æ•°ä¸å°‘äºä¸¤æ¬¡ï¼Œé‚£ä¹ˆå­—ç¬¦$s[0],s[i],s[2i],s[3i]â€¦$å¿…ç„¶ä¼šæœ‰ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šå‡ºç°åœ¨è¯¥å­ä¸²ä¸­ï¼Œä¸å¦¨è®¾å‰ä¸¤ä¸ªå­—ç¬¦ä¸º$s[j],s[j+i]$ï¼Œæˆ‘ä»¬è®°$lcp(j,j+i)$ä¸º$cnt$æˆ‘ä»¬è€ƒè™‘ä¸¤ç§æƒ…å†µ å¦‚æœ$s[j]$æ˜¯å­ä¸²çš„é¦–å­—ç¬¦ï¼Œé‚£ä¹ˆè¯¥å­ä¸²çš„å¾ªç¯èŠ‚é‡å¤æ¬¡æ•°ä¸º$cnt/i$ï¼Œæ­¤æ—¶å­ä¸²ä¸º$s[jâ€¦j+i+cnt-cnt%i]$ å¦åˆ™ï¼Œ$s[j]$å·¦ä¾§çš„$i-cnt%i$ä¸ªå­—ç¬¦æœ‰å¯èƒ½å¯ä»¥ç»§ç»­æ‹¼å‡‘å‡ºä¸€ä¸ªå¾ªç¯èŠ‚ï¼Œæˆ‘ä»¬è®°æ­¤æ—¶çš„èµ·ç‚¹$j-(i-cnt%i)$ä¸º$k$ï¼Œå½“$lcp(k,k+i) \\geqslant i$åˆ™å¯ä»¥æ‹¼å‡‘ï¼Œæ­¤æ—¶å­ä¸²ä¸º$s[kâ€¦j+i+cnt]$ ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:11:2","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/10"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; const int maxn=4e5+5; int n,m; int N,M,rk[maxn],sa[maxn],tp[maxn],tax[maxn],px[maxn],ht[maxn]; char s[maxn]; void ssort(){ for(int i=0;i\u003c=M;i++)tax[i]=0; for(int i=1;i\u003c=N;i++)tax[px[i]=rk[tp[i]]]++; for(int i=1;i\u003c=M;i++)tax[i]+=tax[i-1]; for(int i=N;i\u003e0;i--)sa[tax[px[i]]--]=tp[i]; } inline bool cmp(int x,int y,int w){ return tp[x]==tp[y]\u0026\u0026tp[x+w]==tp[y+w]; } void SuffixArray(){ M=75; N=strlen(s+1); memset(rk,0,sizeof rk); for(int i=1;i\u003c=N;i++)rk[i]=s[i]-'0'+1,tp[i]=i; ssort(); for(int w=1,p=0;p\u003cN;M=p,w\u003c\u003c=1){ p=0; for(int i=1;i\u003c=w;i++)tp[++p]=N-w+i; for(int i=1;i\u003c=N;i++)if(sa[i]\u003ew)tp[++p]=sa[i]-w; ssort(); memcpy(tp,rk,sizeof rk); rk[sa[1]]=p=1; for(int i=2;i\u003c=N;i++)rk[sa[i]]=cmp(sa[i],sa[i-1],w)?p:++p; } } void Height(){ int j,k=0; for(int i=1;i\u003c=N;i++){ if(k)k--; int j=sa[rk[i]-1]; while(s[i+k]==s[j+k])k++; ht[rk[i]]=k; } } int st[maxn][30],plg[maxn]; void ST_pre(){ plg[1]=0; for(int i=2;i\u003c=N;i++)plg[i]=plg[i/2]+1; for(int i=1;i\u003c=N;i++)st[i][0]=ht[i]; for(int j=1;j\u003c=plg[N];j++){ for(int i=1;i\u003c=N-(1\u003c\u003cj)+1;i++){ st[i][j]=min(st[i][j-1],st[i+(1\u003c\u003c(j-1))][j-1]); } } } int ST_query(int l,int r){ int k=plg[r-l+1]; return min(st[l][k],st[r-(1\u003c\u003ck)+1][k]); } int lcp(int a,int b){//ç¬¬aä¸ªåç¼€ä¸ç¬¬bä¸ªåç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€ a=rk[a],b=rk[b]; if(a\u003eb)swap(a,b); return ST_query(a+1,b); } inline void solve(){ cin\u003e\u003e(s+1); SuffixArray(); Height(); ST_pre(); int ans=1; for(int i=1;i\u003c=N;i++){ for(int j=1;j+i\u003c=N;j+=i){ int cnt=lcp(j,j+i); int k=j-(i-cnt%i); cnt=cnt/i+1; if(k\u003e=1\u0026\u0026lcp(k,k+i)\u003e=i)cnt++; ans=max(cnt,ans); } } cout\u003c\u003cans\u003c\u003cendl; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; while(__--){ solve(); } return 0; } å°ç»“ é€šè¿‡è¿™ä¹ˆå¤šé¢˜ç®—æ˜¯å¯¹åç¼€æ•°ç»„æœ‰äº†ä¸€ä¸ªåˆæ­¥çš„äº†è§£ï¼Œæ„Ÿå¹ä¸€ä¸‹è¿˜æ˜¯è‡ªå·±ä¼šçš„ä¸œè¥¿å¤ªå°‘äº†ï¼Œåœ¨åšä¸å•è°ƒæ ˆç»“åˆçš„é¢˜ç›®è´¹äº†å¾ˆå¤§çš„åŠŸå¤« åç¼€æ•°ç»„çš„å­¦ä¹ åˆ°è¿™é‡Œç®—æ˜¯å‘Šä¸€æ®µè½äº† ","date":"2021-10-02","objectID":"/posts/edusuffixarray/:11:3","tags":["codeforces","EDU","suffix array"],"title":"Codeforces Edu SuffixArray","uri":"/posts/edusuffixarray/"},{"categories":["2021/8"],"content":"ä¼ é€é—¨ ","date":"2021-08-28","objectID":"/posts/cf126b/:0:0","tags":["codeforces","KMP"],"title":"Codeforces 126B Password","uri":"/posts/cf126b/"},{"categories":["2021/8"],"content":"é¢˜æ„ ç»™ä¸€ä¸ªå­—ç¬¦ä¸²$S$ï¼Œæ‰¾åˆ°æœ€é•¿çš„å­—ç¬¦ä¸²$T$åŒæ—¶ä¸º$S$çš„å‰ç¼€ã€åç¼€ä¸”ä½œä¸ºéå‰åç¼€å‡ºç°åœ¨å­—ç¬¦ä¸²ä¸­ ","date":"2021-08-28","objectID":"/posts/cf126b/:0:1","tags":["codeforces","KMP"],"title":"Codeforces 126B Password","uri":"/posts/cf126b/"},{"categories":["2021/8"],"content":"æ€è·¯ åˆ©ç”¨nextæ•°ç»„æ±‚å‡ºä¸²$S$æ‰€æœ‰ç›¸åŒçš„å‰åç¼€ï¼Œç„¶åéå†nextæ•°ç»„æŸ¥æ‰¾å‡ºç°çš„æœ€é•¿çš„ä¸”ä¸ä¸Šä¸€æ­¥æ±‚å¾—çš„ç›¸åŒçš„å‰åç¼€çš„ç›¸åŒå­ä¸²å³å¯ ","date":"2021-08-28","objectID":"/posts/cf126b/:0:2","tags":["codeforces","KMP"],"title":"Codeforces 126B Password","uri":"/posts/cf126b/"},{"categories":["2021/8"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; #define endl '\\n' const int maxn=1e6+5; string s; int nxt[maxn]; void kmp_pre(string s,int* nxt){ int i,j; j=nxt[0]=-1; i=0; while(i\u003cs.size()){ while(j!=-1\u0026\u0026s[i]!=s[j])j=nxt[j]; nxt[++i]=++j; } } inline void solve(){ cin\u003e\u003es; kmp_pre(s,nxt); map\u003cint,int\u003e mp; int t=nxt[s.size()]; while(t!=-1){ mp[t]=1; t=nxt[t]; } int ans=0; for(int i=2;i\u003cs.size();i++){ if(mp[nxt[i]])ans=max(ans,nxt[i]); } if(ans){ for(int i=0;i\u003cans;i++)cout\u003c\u003cs[i]; cout\u003c\u003cendl; }else cout\u003c\u003c\"Just a legend\"\u003c\u003cendl; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; while(__--){ solve(); } return 0; } ","date":"2021-08-28","objectID":"/posts/cf126b/:0:3","tags":["codeforces","KMP"],"title":"Codeforces 126B Password","uri":"/posts/cf126b/"},{"categories":["2021/8"],"content":"å°ç»“ æç½®äº†å¾ˆä¹…çš„ä¸€é“é¢˜ï¼Œå¯¹nextæ•°ç»„çš„ç®€å•åº”ç”¨ï¼Œä»Šå¤©çœ‹äº†ä¸€ä¸‹ç›´æ¥ç§’æ‰äº† ","date":"2021-08-28","objectID":"/posts/cf126b/:0:4","tags":["codeforces","KMP"],"title":"Codeforces 126B Password","uri":"/posts/cf126b/"},{"categories":["2021/8"],"content":"ä¼ é€é—¨ ","date":"2021-08-28","objectID":"/posts/cf1562e/:0:0","tags":["codeforces","suffix array","sparse table"],"title":"Codeforces 1562E Rescue Niwen!","uri":"/posts/cf1562e/"},{"categories":["2021/8"],"content":"é¢˜æ„ å°†ä¸€ä¸ªå­—ç¬¦ä¸²æŒ‰å¦‚ä¸‹å½¢å¼æ‹†åˆ†ä¸ºè‹¥å¹²ä¸ªä¸²ï¼š ä»¥$abcd$ä¸ºä¾‹ï¼Œæ‹†åˆ†ä¸º$a,ab,abc,abcd,b,bc,bcd,c,cd,d$ è¾“å‡ºæœ€é•¿çš„å­—å…¸åºä¸¥æ ¼ä¸Šå‡çš„å­åºåˆ—ï¼ˆå¯ä»¥ä¸è¿ç»­ï¼‰çš„é•¿åº¦ ","date":"2021-08-28","objectID":"/posts/cf1562e/:0:1","tags":["codeforces","suffix array","sparse table"],"title":"Codeforces 1562E Rescue Niwen!","uri":"/posts/cf1562e/"},{"categories":["2021/8"],"content":"æ€è·¯ å°†æ‰€æœ‰ä¸²æŒ‰åŸä¸²åç¼€åˆ†ç»„ å¯¹äºä»»æ„åç¼€$i$ï¼Œå…¶æœ€å¤§è´¡çŒ®ä¸º$n-i+1$ï¼Œå½“ä¸”ä»…å½“åç¼€$j\u003ei$ä¸”$rk[j]\u003erk[i]$æ—¶ï¼Œåç¼€$j$å¯ç½®äºåç¼€$i$ä¹‹åï¼Œä¸”è´¡çŒ®åº¦ä¸º$n-i+1-lcp(i,j)$ ","date":"2021-08-28","objectID":"/posts/cf1562e/:0:2","tags":["codeforces","suffix array","sparse table"],"title":"Codeforces 1562E Rescue Niwen!","uri":"/posts/cf1562e/"},{"categories":["2021/8"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; #define endl '\\n' typedef long long ll; const int maxn=5e3+5; int n,m; int N,M,rk[maxn],sa[maxn],tp[maxn],tax[maxn],px[maxn],ht[maxn]; char s[maxn]; ll ans[maxn]; void ssort(){ for(int i=0;i\u003c=M;i++)tax[i]=0; for(int i=1;i\u003c=N;i++)tax[px[i]=rk[tp[i]]]++; for(int i=1;i\u003c=M;i++)tax[i]+=tax[i-1]; for(int i=N;i\u003e0;i--)sa[tax[px[i]]--]=tp[i]; } inline bool cmp(int x,int y,int w){ return tp[x]==tp[y]\u0026\u0026tp[x+w]==tp[y+w]; } void SuffixArray(){ M=75; N=strlen(s+1); memset(rk,0,sizeof rk); for(int i=1;i\u003c=N;i++)rk[i]=s[i]-'0'+1,tp[i]=i; ssort(); for(int w=1,p=0;p\u003cN;M=p,w\u003c\u003c=1){ p=0; for(int i=1;i\u003c=w;i++)tp[++p]=N-w+i; for(int i=1;i\u003c=N;i++)if(sa[i]\u003ew)tp[++p]=sa[i]-w; ssort(); memcpy(tp,rk,sizeof rk); rk[sa[1]]=p=1; for(int i=2;i\u003c=N;i++)rk[sa[i]]=cmp(sa[i],sa[i-1],w)?p:++p; } } void Height(){ int j,k=0; for(int i=1;i\u003c=N;i++){ if(k)k--; int j=sa[rk[i]-1]; while(s[i+k]==s[j+k])k++; ht[rk[i]]=k; } } int st[maxn][30],plg[maxn]; void ST_pre(){ plg[1]=0; for(int i=2;i\u003c=n;i++)plg[i]=plg[i/2]+1; for(int i=1;i\u003c=n;i++)st[i][0]=ht[i]; for(int j=1;j\u003c=plg[n];j++){ for(int i=1;i\u003c=n-(1\u003c\u003cj)+1;i++){ st[i][j]=min(st[i][j-1],st[i+(1\u003c\u003c(j-1))][j-1]); } } } int ST_query(int l,int r){ int k=plg[r-l+1]; return min(st[l][k],st[r-(1\u003c\u003ck)+1][k]); } int lcp(int a,int b){//æ’åç¬¬açš„åç¼€ä¸æ’åç¬¬bçš„åç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€ if(a\u003eb)swap(a,b); return ST_query(a+1,b); } inline void solve(){ cin\u003e\u003en\u003e\u003e(s+1); SuffixArray(); Height(); ST_pre(); ll res=0; for(int i=1;i\u003c=n;i++){ int x=sa[i]; ans[x]=n-x+1; for(int j=1;j\u003ci;j++){ if(sa[j]\u003cx)ans[x]=max(ans[x],ans[sa[j]]+n-x+1-lcp(j,i)); } res=max(res,ans[x]); } cout\u003c\u003cres\u003c\u003cendl; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; cin\u003e\u003e__; while(__--){ solve(); } return 0; } ","date":"2021-08-28","objectID":"/posts/cf1562e/:0:3","tags":["codeforces","suffix array","sparse table"],"title":"Codeforces 1562E Rescue Niwen!","uri":"/posts/cf1562e/"},{"categories":["2021/8"],"content":"å°ç»“ æœ€è¿‘ä¸€ç›´åœ¨å­¦çš„åç¼€æ•°ç»„å±…ç„¶ç°åœºé‡åˆ°äº†æ²¡åšå‡ºæ¥ï¼ŒçœŸæ˜¯ç¦»ç´«åæœ€è¿‘çš„ä¸€å› ğŸ˜­ ","date":"2021-08-28","objectID":"/posts/cf1562e/:0:4","tags":["codeforces","suffix array","sparse table"],"title":"Codeforces 1562E Rescue Niwen!","uri":"/posts/cf1562e/"},{"categories":["2021/8"],"content":"ä¼ é€é—¨ ","date":"2021-08-25","objectID":"/posts/poj3463/:0:0","tags":["poj","dijkstra"],"title":"POJ 3463 Sightseeing","uri":"/posts/poj3463/"},{"categories":["2021/8"],"content":"é¢˜æ„ ç»™ä¸€å¼ å›¾ï¼Œæ±‚åˆ°ç»ˆç‚¹æœ€çŸ­è·¯ä¸ªæ•°ä»¥åŠä¸æœ€çŸ­è·¯ç›¸å·®ä¸º1çš„æ¬¡çŸ­è·¯çš„ä¸ªæ•°ä¹‹å’Œ ","date":"2021-08-25","objectID":"/posts/poj3463/:0:1","tags":["poj","dijkstra"],"title":"POJ 3463 Sightseeing","uri":"/posts/poj3463/"},{"categories":["2021/8"],"content":"æ€è·¯ æœ€çŸ­è·¯è®¡æ•°å’Œæ¬¡çŸ­è·¯è®¡æ•°çš„æ¨¡æ¿é¢˜ï¼Œå°†æ¬¡çŸ­è·¯ä¸¢å…¥ä¼˜å…ˆé˜Ÿåˆ—ä¸­å³å¯ã€‚ ","date":"2021-08-25","objectID":"/posts/poj3463/:0:2","tags":["poj","dijkstra"],"title":"POJ 3463 Sightseeing","uri":"/posts/poj3463/"},{"categories":["2021/8"],"content":"ä»£ç  /** * Author: ShacozzZ * Created: 2021-08-25 21:23:21 **/ #include\u003calgorithm\u003e#include\u003ciostream\u003e#include\u003cmap\u003e#include\u003cqueue\u003e#include\u003cvector\u003eusing namespace std; #define endl '\\n' #define x first #define y second typedef long long ll; typedef pair\u003cint,int\u003e P; const int inf=0x3f3f3f3f; const int maxn=1e5+5; int n,m; struct edge{ int v,w; edge(){} edge(int vv,int ww){v=vv;w=ww;} }; struct node{ int x,y,z; node(){} node(int xx,int yy,int zz){x=xx;y=yy;z=zz;} bool operator\u003e(const node \u0026b)const{return x\u003eb.x;} }; vector\u003cedge\u003e g[maxn]; int st,en,dis1[maxn],dis2[maxn],cnt1[maxn],cnt2[maxn]; void init(){ for(int i=0;i\u003c=n;i++){ g[i].clear(); dis1[i]=dis2[i]=inf; cnt1[i]=cnt2[i]=0; } } void dij(){ priority_queue\u003cnode,vector\u003cnode\u003e,greater\u003cnode\u003e\u003e q; dis1[st]=0; cnt1[st]=1; q.push(node(0,st,1)); while(!q.empty()){ node p=q.top(); q.pop(); int u=p.y; int d=p.x; int num=(p.z==1?cnt1[u]:cnt2[u]); if(p.z==1\u0026\u0026dis1[u]\u003cp.x)continue; if(p.z==2\u0026\u0026dis2[u]\u003cp.x)continue; for(int i=0;i\u003cg[u].size();i++){ int v=g[u][i].v,w=g[u][i].w; if(d+w\u003cdis1[v]){ dis2[v]=dis1[v]; cnt2[v]=cnt1[v]; q.push(node(dis2[v],v,2)); dis1[v]=d+w; cnt1[v]=num; q.push(node(dis1[v],v,1)); }else if(d+w==dis1[v])cnt1[v]+=num; else if(d+w\u003cdis2[v]){ dis2[v]=d+w; cnt2[v]=num; q.push(node(dis2[v],v,2)); }else if(d+w==dis2[v])cnt2[v]+=num; } } } inline void solve(){ cin\u003e\u003en\u003e\u003em; int u,v,w; init(); for(int i=0;i\u003cm;i++){ cin\u003e\u003eu\u003e\u003ev\u003e\u003ew; g[u].push_back(edge(v,w)); } cin\u003e\u003est\u003e\u003een; dij(); cout\u003c\u003c(dis2[en]-dis1[en]==1?cnt1[en]+cnt2[en]:cnt1[en])\u003c\u003cendl; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; cin\u003e\u003e__; while(__--){ solve(); } return 0; } ","date":"2021-08-25","objectID":"/posts/poj3463/:0:3","tags":["poj","dijkstra"],"title":"POJ 3463 Sightseeing","uri":"/posts/poj3463/"},{"categories":["2021/8"],"content":"å°ç»“ å¯¹æœ€çŸ­è·¯çš„ç†è§£åˆåŠ æ·±äº†ï¼ˆå¥½è€¶ ","date":"2021-08-25","objectID":"/posts/poj3463/:0:4","tags":["poj","dijkstra"],"title":"POJ 3463 Sightseeing","uri":"/posts/poj3463/"},{"categories":["2021/8"],"content":"ä¼ é€é—¨ ","date":"2021-08-12","objectID":"/posts/gym103145c/:0:0","tags":["gym","dp","tree"],"title":"2021CCPCä¸œåŒ—å››çœèµ› C Vertex Deletion","uri":"/posts/gym103145c/"},{"categories":["2021/8"],"content":"é¢˜æ„ é—®æœ‰å¤šå°‘ç§åˆ ç‚¹æ–¹æ¡ˆä½¿å¾—å‰©ä¸‹çš„ç‚¹è‡³å°‘ä¸ä¸€ä¸ªç‚¹ç›¸è¿ ","date":"2021-08-12","objectID":"/posts/gym103145c/:0:1","tags":["gym","dp","tree"],"title":"2021CCPCä¸œåŒ—å››çœèµ› C Vertex Deletion","uri":"/posts/gym103145c/"},{"categories":["2021/8"],"content":"æ€è·¯ å®šä¹‰$dp[i][0/1/2]$ä»£è¡¨å¯¹äºèŠ‚ç‚¹iä¸ºæ ¹çš„å­æ ‘ï¼Œå°†èŠ‚ç‚¹$i$åˆ å»ã€ä¿ç•™èŠ‚ç‚¹$i$ä¸”èŠ‚ç‚¹$i$åªä¸çˆ¶èŠ‚ç‚¹ç›¸è¿ã€ä¿ç•™èŠ‚ç‚¹$i$ä¸”ä¸å­èŠ‚ç‚¹ç›¸è¿çš„æ–¹æ¡ˆæ•° å¯¹äºç¬¬ä¸‰ç§æƒ…å†µï¼Œé€šè¿‡å…ˆç®—å¾—ä¿ç•™èŠ‚ç‚¹içš„æ‰€æœ‰æ–¹æ¡ˆæ•°å‡å»ä¸åˆæ³•çš„æ–¹æ¡ˆæ•°ï¼Œå³å‡å»ç¬¬äºŒç§æƒ…å†µçš„æ–¹æ¡ˆæ•° çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š $dp[u][0]=\\prod_{v\\in son_{u}}(dp[v][0]+dp[v][2])$ $dp[u][1]=\\prod_{v\\in son_{u}}dp[v][0]$ $dp[u][2]=\\prod_{v\\in son_{u}}(dp[v][0]+dp[v][1]+dp[v][2])-dp[u][1]$ ","date":"2021-08-12","objectID":"/posts/gym103145c/:0:2","tags":["gym","dp","tree"],"title":"2021CCPCä¸œåŒ—å››çœèµ› C Vertex Deletion","uri":"/posts/gym103145c/"},{"categories":["2021/8"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; #define endl '\\n' typedef long long ll; const int md=998244353; const int maxn=2e5+5; int n,m; ll dp[maxn][3]; vector\u003cint\u003e g[maxn]; void dfs(int u,int fa){ for(int v:g[u]){ if(v==fa)continue; dfs(v,u); dp[u][0]=dp[u][0]*(dp[v][0]+dp[v][2])%md;; dp[u][1]=dp[u][1]*dp[v][0]%md; dp[u][2]=dp[u][2]*(dp[v][0]+dp[v][1]+dp[v][2])%md; } dp[u][2]-=dp[u][1]; if(dp[u][2])dp[u][2]+=md; } inline void solve(){ cin\u003e\u003en; for(int i=1;i\u003c=n;i++)dp[i][0]=dp[i][1]=dp[i][2]=1,g[i].clear(); int u,v; for(int i=1;i\u003cn;i++){ cin\u003e\u003eu\u003e\u003ev; g[u].push_back(v); g[v].push_back(u); } dfs(1,0); cout\u003c\u003c(dp[1][0]+dp[1][2])%md\u003c\u003cendl; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; cin\u003e\u003e__; while(__--){ solve(); } return 0; } ","date":"2021-08-12","objectID":"/posts/gym103145c/:0:3","tags":["gym","dp","tree"],"title":"2021CCPCä¸œåŒ—å››çœèµ› C Vertex Deletion","uri":"/posts/gym103145c/"},{"categories":["2021/8"],"content":"å°ç»“ è®­ç»ƒèµ›è¡¥é¢˜ï¼Œç¦»è°±çš„äº‹åœ¨è®­ç»ƒèµ›æ—¶æ‰‹åŠ¨æ¨¡æ‹Ÿéƒ½æ²¡æœ‰æ•°å‡ºæ ·ä¾‹ä¸­çš„22ç§æ–¹æ¡ˆï¼ˆç¬‘ï¼‰ ","date":"2021-08-12","objectID":"/posts/gym103145c/:0:4","tags":["gym","dp","tree"],"title":"2021CCPCä¸œåŒ—å››çœèµ› C Vertex Deletion","uri":"/posts/gym103145c/"},{"categories":["2021/7"],"content":"ä¼ é€é—¨ ","date":"2021-07-27","objectID":"/posts/cf1454f/:0:0","tags":["codeforces","segment tree"," binary search"],"title":"Codeforces 1454F Array Partition","uri":"/posts/cf1454f/"},{"categories":["2021/7"],"content":"é¢˜æ„ ç»™ä¸€ä¸ªæ•°ç»„ï¼Œåˆ†å‰²æˆä¸‰ä¸ªåŒºé—´ï¼Œä½¿å¾—å·¦åŒºé—´çš„æœ€å¤§å€¼ç­‰äºä¸­é—´åŒºé—´çš„æœ€å°å€¼ç­‰äºå³åŒºé—´çš„æœ€å¤§å€¼ ","date":"2021-07-27","objectID":"/posts/cf1454f/:0:1","tags":["codeforces","segment tree"," binary search"],"title":"Codeforces 1454F Array Partition","uri":"/posts/cf1454f/"},{"categories":["2021/7"],"content":"æ€è·¯ é¦–å…ˆç”¨çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´çš„æœ€å¤§å€¼æœ€å°å€¼ä¸éš¾æƒ³åˆ°ï¼Œç„¶åéå†æ•°ç»„ï¼Œå†ç¡®å®šä¸€ä¸ªæ–­ç‚¹çš„æ¡ä»¶ï¼ˆå³ç¡®å®šäº†å·¦åŒºé—´ï¼‰ä¸‹ï¼Œå‘ç°å¦å¤–ä¸€ä¸ªæ–­ç‚¹æ‰€ç¡®å®šçš„ä¸¤ä¸ªåŒºé—´çš„æœ€å¤§å€¼å’Œæœ€å°å€¼éƒ½æ˜¯å…·æœ‰å•è°ƒæ€§çš„ï¼Œå³ï¼šä¸­é—´åŒºé—´è¶Šå¤§åˆ™æœ€å°å€¼è¶Šå°ä¸”å³åŒºé—´æœ€å¤§å€¼è¶Šå° æ—¶é—´å¤æ‚åº¦$O(nlognlogn)$ ","date":"2021-07-27","objectID":"/posts/cf1454f/:0:2","tags":["codeforces","segment tree"," binary search"],"title":"Codeforces 1454F Array Partition","uri":"/posts/cf1454f/"},{"categories":["2021/7"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; #define endl '\\n' typedef long long ll; const int inf=0x3f3f3f3f; const int maxn=2e5+5; int n,m,a[maxn]; ll num[maxn]; struct seq_node{ int l,r; ll mn,mx; }tree[maxn\u003c\u003c2]; inline void pushup(int o){ tree[o].mn=min(tree[o\u003c\u003c1].mn,tree[o\u003c\u003c1|1].mn); tree[o].mx=max(tree[o\u003c\u003c1].mx,tree[o\u003c\u003c1|1].mx); } void build_tree(int l,int r,int o){ tree[o].l=l,tree[o].r=r; if(l==r){ tree[o].mx=tree[o].mn=num[l]; return ; } int mid=(l+r)\u003e\u003e1; build_tree(l,mid,o\u003c\u003c1); build_tree(mid+1,r,o\u003c\u003c1|1); pushup(o); } int query_mx(int l,int r,int o){ if(tree[o].l\u003e=l\u0026\u0026tree[o].r\u003c=r)return tree[o].mx; int mid=(tree[o].l+tree[o].r)\u003e\u003e1; int mx=0; if(l\u003c=mid)mx=max(mx,query_mx(l,r,o\u003c\u003c1)); if(r\u003emid)mx=max(mx,query_mx(l,r,o\u003c\u003c1|1)); return mx; } int query_mn(int l,int r,int o){ if(tree[o].l\u003e=l\u0026\u0026tree[o].r\u003c=r)return tree[o].mn; int mid=(tree[o].l+tree[o].r)\u003e\u003e1; int mn=inf; if(l\u003c=mid)mn=min(mn,query_mn(l,r,o\u003c\u003c1)); if(r\u003emid)mn=min(mn,query_mn(l,r,o\u003c\u003c1|1)); return mn; } inline void solve(){ cin\u003e\u003en; for(int i=1;i\u003c=n;i++)cin\u003e\u003enum[i]; build_tree(1,n,1); for(int i=1;i\u003cn-1;i++){ int l=i+1,r=n-1; int mx1=query_mx(1,i,1),mn,mx2; while(l\u003c=r){ int mid=(l+r)\u003e\u003e1; // ck(mid) mn=query_mn(i+1,mid,1); mx2=query_mx(mid+1,n,1); if(mn\u003emx1||mx2\u003emx1)l=mid+1; else if(mn\u003cmx1||mx2\u003cmx1)r=mid-1; else{ cout\u003c\u003c\"YES\"\u003c\u003cendl; cout\u003c\u003ci\u003c\u003c\" \"\u003c\u003cmid-i\u003c\u003c\" \"\u003c\u003cn-mid\u003c\u003cendl; return ; } } } cout\u003c\u003c\"NO\"\u003c\u003cendl; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; cin\u003e\u003e__; while(__--){ solve(); } return 0; } ","date":"2021-07-27","objectID":"/posts/cf1454f/:0:3","tags":["codeforces","segment tree"," binary search"],"title":"Codeforces 1454F Array Partition","uri":"/posts/cf1454f/"},{"categories":["2021/7"],"content":"å°ç»“ å¤§æ¦‚æ˜¯ç¨å¾®å¤ä¹ äº†ä¸€ä¸‹çº¿æ®µæ ‘ï¼ŒäºŒåˆ†çš„æ€è·¯å¾ˆå·§å¦™ï¼Œä¹Ÿæ˜¯é€šè¿‡çœ‹äº†åˆ«äººçš„é¢˜è§£æ‰æƒ³åˆ°çš„ ","date":"2021-07-27","objectID":"/posts/cf1454f/:0:4","tags":["codeforces","segment tree"," binary search"],"title":"Codeforces 1454F Array Partition","uri":"/posts/cf1454f/"},{"categories":["2021/7"],"content":"ä¼ é€é—¨ ","date":"2021-07-26","objectID":"/posts/cf1454e/:0:0","tags":["codeforces","dfs"],"title":"Codeforces 1454E Number of Simple Paths","uri":"/posts/cf1454e/"},{"categories":["2021/7"],"content":"é¢˜æ„ ç»™$n$ä¸ªç‚¹$n$æ¡è¾¹çš„æ— å‘å›¾ï¼Œæ±‚æœ‰å¤šå°‘æ¡ç®€å•è·¯å¾„ ","date":"2021-07-26","objectID":"/posts/cf1454e/:0:1","tags":["codeforces","dfs"],"title":"Codeforces 1454E Number of Simple Paths","uri":"/posts/cf1454e/"},{"categories":["2021/7"],"content":"æ€è·¯ ä¸éš¾å‘ç°å›¾ä¸ºä¸€æ£µæ ‘å¢åŠ ä¸€æ¡è¾¹ä½¿å¾—æ ‘ä¸­å‡ºç°äº†ä¸€ä¸ªç¯ï¼Œé¦–å…ˆæ‰¾å‡ºç¯ï¼Œç„¶åå¦‚æœä¸¤ä¸ªç‚¹ä¹‹é—´ç»è¿‡ç¯ï¼Œåˆ™æœ‰ä¸¤æ¡ç®€å•è·¯å¾„ï¼Œå¦åˆ™ä¸ºä¸€æ¡ é€šè¿‡ä¸¤æ¬¡dfsï¼Œç¬¬ä¸€æ¬¡æ‰¾å‡ºæœ‰å“ªäº›ç‚¹åœ¨ç¯ä¸Šï¼Œç¬¬äºŒæ¬¡è®¡ç®—ç­”æ¡ˆ ","date":"2021-07-26","objectID":"/posts/cf1454e/:0:2","tags":["codeforces","dfs"],"title":"Codeforces 1454E Number of Simple Paths","uri":"/posts/cf1454e/"},{"categories":["2021/7"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; #define endl '\\n' typedef long long ll; const int maxn=2e5+5; const int maxm=1e9; ll n,m,ans; vector\u003cint\u003e g[maxn]; set\u003cint\u003e c; bool vis[maxn]; int fa[maxn]; bool ok=0; void init(){} void dfs1(int u){ vis[u]=1; for(int i=0;i\u003cg[u].size();i++){ if(ok)return ; int v=g[u][i]; if(v!=fa[u]){ if(vis[v]){ while(u!=v){ c.insert(u); u=fa[u]; } c.insert(v); ok=1; }else{ fa[v]=u; dfs1(v); } } } } ll dfs2(int u){ ll res=1; vis[u]=1; for(int i=0;i\u003cg[u].size();i++){ int v=g[u][i]; if(!vis[v]\u0026\u0026(!c.count(u)||!c.count(v))){ res+=dfs2(v); } } return res; } inline void solve(){ cin\u003e\u003en; for(int i=0;i\u003c=n;i++){ g[i].clear(); vis[i]=0; } c.clear(); ans=ok=0; for(int i=1;i\u003c=n;i++){ int u,v; cin\u003e\u003eu\u003e\u003ev; g[u].push_back(v); g[v].push_back(u); } dfs1(1); for(int i=0;i\u003c=n;i++)vis[i]=0; for(int i=1;i\u003c=n;i++){ if(!vis[i]){ ll res=dfs2(i); ans+=res*(res-1)/2+res*(n-res); } } cout\u003c\u003cans\u003c\u003cendl; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; cin\u003e\u003e__; while(__--){ solve(); } return 0; } ","date":"2021-07-26","objectID":"/posts/cf1454e/:0:3","tags":["codeforces","dfs"],"title":"Codeforces 1454E Number of Simple Paths","uri":"/posts/cf1454e/"},{"categories":["2021/7"],"content":"å°ç»“ å¾ˆç®€å•çš„ä¸€ä¸ªé¢˜ï¼Œé›¶é›¶ç¢ç¢çš„bugæ‰¾äº†å¤ªä¹…äº† ","date":"2021-07-26","objectID":"/posts/cf1454e/:0:4","tags":["codeforces","dfs"],"title":"Codeforces 1454E Number of Simple Paths","uri":"/posts/cf1454e/"},{"categories":["2021/7"],"content":"ä¼ é€é—¨ ","date":"2021-07-21","objectID":"/posts/cf1385e/:0:0","tags":["codeforces","topological sorting"],"title":"Codeforces 1385E Directing Edges","uri":"/posts/cf1385e/"},{"categories":["2021/7"],"content":"é¢˜æ„ ç»™ä¸€ä¸ªå›¾åŒ…å«æœ‰å‘è¾¹å’Œæ— å‘è¾¹ï¼Œå°†æ‰€æœ‰æ— å‘è¾¹æ”¹ä¸ºæœ‰å‘è¾¹å¹¶ä¸”ä½¿å›¾ä¸­ä¸å­˜åœ¨ç¯ ","date":"2021-07-21","objectID":"/posts/cf1385e/:0:1","tags":["codeforces","topological sorting"],"title":"Codeforces 1385E Directing Edges","uri":"/posts/cf1385e/"},{"categories":["2021/7"],"content":"æ€è·¯ é¦–å…ˆåˆ é™¤æ‰æ‰€æœ‰æœ‰å‘è¾¹ï¼Œé€šè¿‡æ‹“æ‰‘æ’åºåˆ¤æ–­æ˜¯å¦æœ‰ç¯ï¼Œå¦‚æœä¸å­˜åœ¨ç¯ï¼Œåˆ™å°†æ— å‘è¾¹æ”¹ä¸ºç”±æ‹“æ‰‘åºå°çš„ç‚¹æŒ‡å‘æ‹“æ‰‘åºå¤§çš„ç‚¹çš„æœ‰å‘è¾¹ ","date":"2021-07-21","objectID":"/posts/cf1385e/:0:2","tags":["codeforces","topological sorting"],"title":"Codeforces 1385E Directing Edges","uri":"/posts/cf1385e/"},{"categories":["2021/7"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; #define endl '\\n' #define x first #define y second typedef pair\u003cint,int\u003e Pii; const int maxn=2e5+5; int n,m,rk[maxn]; vector\u003cPii\u003e e; void init(){} vector\u003cint\u003e g[maxn]; vector\u003cint\u003e topo; int vis[maxn]; bool dfs(int u){ vis[u]=-1; for(auto v:g[u]){ if(vis[v]\u003c0)return 0; else if(!vis[v]\u0026\u0026!dfs(v))return 0; } vis[u]=1; topo.push_back(u); return 1; } bool toposort(){ topo.clear(); for(int i=0;i\u003c=n;i++)vis[i]=0; for(int u=1;u\u003c=n;u++){ if(!vis[u]\u0026\u0026!dfs(u))return 0; } reverse(topo.begin(),topo.end()); return 1; } inline void solve(){ cin\u003e\u003en\u003e\u003em; for(int i=1;i\u003c=n;i++){ vis[i]=0; g[i].clear(); } e.clear(); for(int i=0;i\u003cm;i++){ int u,v,w; cin\u003e\u003ew\u003e\u003eu\u003e\u003ev; if(w){ g[u].push_back(v); in[v]++; }else e.push_back({u,v}); } if(!toposort()){ cout\u003c\u003c\"NO\"\u003c\u003cendl; return ; } for(int i=0;i\u003ctopo.size();i++)rk[topo[i]]=i; cout\u003c\u003c\"YES\"\u003c\u003cendl; for(int u=1;u\u003c=n;u++){ for(auto v:g[u])cout\u003c\u003cu\u003c\u003c\" \"\u003c\u003cv\u003c\u003cendl; } for(auto p:e){ if(rk[p.x]\u003crk[p.y])cout\u003c\u003cp.x\u003c\u003c\" \"\u003c\u003cp.y\u003c\u003cendl; else cout\u003c\u003cp.y\u003c\u003c\" \"\u003c\u003cp.x\u003c\u003cendl; } } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; cin\u003e\u003e__; while(__--){ solve(); } return 0; } #include\u003cbits/stdc++.h\u003eusing namespace std; #define endl '\\n' #define x first #define y second typedef pair\u003cint,int\u003e Pii; const int maxn=2e5+5; int n,m,rk[maxn]; vector\u003cPii\u003e e; void init(){} vector\u003cint\u003e g[maxn]; vector\u003cint\u003e topo; int in[maxn]; bool toposort(){ topo.clear(); for(int u=1;u\u003c=n;u++){ for(auto v:g[u])in[v]++; } int cnt=0; queue\u003cint\u003e q; for(int u=1;u\u003c=n;u++)if(!in[u])q.push(u); while(q.size()){ int u=q.front(); q.pop(); cnt++; topo.push_back(u); for(auto v:g[u])if(!--in[v])q.push(v); } return cnt==n; } inline void solve(){ cin\u003e\u003en\u003e\u003em; for(int i=1;i\u003c=n;i++){ in[i]=0; g[i].clear(); } e.clear(); for(int i=0;i\u003cm;i++){ int u,v,w; cin\u003e\u003ew\u003e\u003eu\u003e\u003ev; if(w){ g[u].push_back(v); }else e.push_back({u,v}); } if(!toposort()){ cout\u003c\u003c\"NO\"\u003c\u003cendl; return ; } for(int i=0;i\u003ctopo.size();i++)rk[topo[i]]=i; cout\u003c\u003c\"YES\"\u003c\u003cendl; for(int u=1;u\u003c=n;u++){ for(auto v:g[u])cout\u003c\u003cu\u003c\u003c\" \"\u003c\u003cv\u003c\u003cendl; } for(auto p:e){ if(rk[p.x]\u003crk[p.y])cout\u003c\u003cp.x\u003c\u003c\" \"\u003c\u003cp.y\u003c\u003cendl; else cout\u003c\u003cp.y\u003c\u003c\" \"\u003c\u003cp.x\u003c\u003cendl; } } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; cin\u003e\u003e__; while(__--){ solve(); } return 0; } ","date":"2021-07-21","objectID":"/posts/cf1385e/:0:3","tags":["codeforces","topological sorting"],"title":"Codeforces 1385E Directing Edges","uri":"/posts/cf1385e/"},{"categories":["2021/7"],"content":"å°ç»“ å¾ˆä¹…æ²¡æœ‰åˆ·è¿‡å›¾è®ºï¼Œé€šè¿‡è¿™ä¸ªé¢˜ç®—æ˜¯å¤ä¹ äº†ä¸€ä¸‹æ‹“æ‰‘æ’åº ","date":"2021-07-21","objectID":"/posts/cf1385e/:0:4","tags":["codeforces","topological sorting"],"title":"Codeforces 1385E Directing Edges","uri":"/posts/cf1385e/"},{"categories":["2021/7"],"content":"ä¼ é€é—¨ ","date":"2021-07-18","objectID":"/posts/cf1200e/:0:0","tags":["codeforces","string hash"],"title":"Codeforces 1200E Compress Words","uri":"/posts/cf1200e/"},{"categories":["2021/7"],"content":"é¢˜æ„ ç»™nä¸ªå­—ç¬¦ä¸²åˆå¹¶æˆä¸€ä¸ªä¸²å¹¶ä¸”åˆå¹¶æ—¶æ¶ˆé™¤åä¸€ä¸ªä¸²æœ€é•¿çš„ä¸å‰ä¸€ä¸ªä¸²åç¼€ç›¸åŒçš„å‰ç¼€ï¼Œå³abä¸bcåˆå¹¶ä¸ºabc ","date":"2021-07-18","objectID":"/posts/cf1200e/:0:1","tags":["codeforces","string hash"],"title":"Codeforces 1200E Compress Words","uri":"/posts/cf1200e/"},{"categories":["2021/7"],"content":"æ€è·¯ å°†å­—ç¬¦ä¸²hashä¹‹åæš´åŠ›å¯»æ‰¾æœ€é•¿çš„ç›¸åŒå‰åç¼€å³å¯ã€‚ç”±äºcodeforcesçš„æ•°æ®è¿˜æ˜¯æ¯”è¾ƒå¼ºçš„ï¼Œä¸ºäº†é˜²æ­¢hashç¢°æ’ï¼Œæœ‰ä¸¤ç§è§£å†³æ–¹æ³• åŒæ¨¡æ•°hash åœ¨æ‰¾åˆ°ç›¸åŒçš„hashå€¼ä¹‹åæš´åŠ›åˆ¤æ–­è¯¥å‰ç¼€å’Œè¯¥åç¼€æ˜¯å¦çœŸæ­£ç›¸åŒ ","date":"2021-07-18","objectID":"/posts/cf1200e/:0:2","tags":["codeforces","string hash"],"title":"Codeforces 1200E Compress Words","uri":"/posts/cf1200e/"},{"categories":["2021/7"],"content":"ä»£ç  #include\u003cbits/stdc++.h\u003eusing namespace std; #define endl '\\n' #define x first #define y second typedef unsigned long long ull; typedef pair\u003cull,ull\u003e P; const int md1=998244353; const int md2=1e9+7; const ull B1=233,B2=131; const int maxn=1e6+5; int n,m; string t,s; vector\u003cP\u003e pre,ss,tt; void init(){ pre.push_back(P(1,1)); for(int i=1;i\u003cmaxn;i++)pre.push_back(P(pre[i-1].x*B1%md1,pre[i-1].y*B2%md2)); } inline void solve(){ cin\u003e\u003en; t.push_back('*'); tt.push_back(P(0,0)); while(cin\u003e\u003es){ ss.clear(); ss.push_back(P(0,0)); for(int i=1;i\u003c=s.size();i++)ss.push_back(P((ss[i-1].x*B1+s[i-1])%md1,(ss[i-1].y*B2+s[i-1])%md2)); int len=0; for(int i=min(t.size(),s.size());i\u003e0;i--){ if((tt[t.size()-1].x+md1-tt[t.size()-i-1].x*pre[i].x%md1)%md1==ss[i].x \u0026\u0026(tt[t.size()-1].y+md2-tt[t.size()-i-1].y*pre[i].y%md2)%md2==ss[i].y){ len=i; break; } } for(int i=len,j=t.size();i\u003cs.size();i++,j++){ t.push_back(s[i]); tt.push_back(P((tt[j-1].x*B1+s[i])%md1,(tt[j-1].y*B2+s[i])%md2)); } } for(int i=1;i\u003ct.size();i++)cout\u003c\u003ct[i]; cout\u003c\u003cendl; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; init(); while(__--){ solve(); } return 0; } #include\u003cbits/stdc++.h\u003eusing namespace std; #define endl '\\n' #define x first #define y second typedef unsigned long long ull; const ull B=233; int n,m; string t,s; vector\u003cull\u003e pre,ss,tt; void init(){ pre.push_back(1); for(int i=1;i\u003cmaxn;i++)pre.push_back(pre[i-1]*B); } inline void solve(){ cin\u003e\u003en; t.push_back('*'); tt.push_back(0); while(cin\u003e\u003es){ ss.clear(); ss.push_back(0); for(int i=1;i\u003c=s.size();i++)ss.push_back(ss[i-1]*B+s[i-1]); int len=0; for(int i=min(t.size(),s.size());i\u003e0;i--){ if(tt[t.size()-1]-tt[t.size()-i-1]*pre[i]==ss[i]){ bool ok=1; for(int j=t.size()-i,k=0;j\u003ct.size()\u0026\u0026k\u003ci;j++,k++){ if(t[j]!=s[k]){ ok=0; break; } } if(ok){ len=i; break; } } } for(int i=len,j=t.size();i\u003cs.size();i++,j++){ t.push_back(s[i]); tt.push_back(tt[j-1]*B+s[i]); } } for(int i=1;i\u003ct.size();i++)cout\u003c\u003ct[i]; cout\u003c\u003cendl; } int main(){ ios::sync_with_stdio(false); cin.tie(0); int __=1; init(); while(__--){ solve(); } return 0; } ","date":"2021-07-18","objectID":"/posts/cf1200e/:0:3","tags":["codeforces","string hash"],"title":"Codeforces 1200E Compress Words","uri":"/posts/cf1200e/"},{"categories":["2021/7"],"content":"å°ç»“ ä¸å¾—ä¸åæ§½Codeforcesçš„æ•°æ®å¤ªç‹ äº†ï¼ˆå¯æƒ³å½“æ—¶æ¯”èµ›çš„æ—¶å€™è¢«hackäº†å¤šå°‘äººï¼‰ï¼Œä¸»è¦æ³¨æ„çš„æ˜¯unsigned long long è‡ªç„¶æº¢å‡ºè¿™ç§hashæ–¹å¼è²Œä¼¼å¾ˆå®¹æ˜“è¢«å¡ ","date":"2021-07-18","objectID":"/posts/cf1200e/:0:4","tags":["codeforces","string hash"],"title":"Codeforces 1200E Compress Words","uri":"/posts/cf1200e/"}]